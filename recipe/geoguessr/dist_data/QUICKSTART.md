# å¿«é€Ÿå¼€å§‹ï¼šåˆ†å¸ƒå¼æ•°æ®åŠ è½½

## ğŸ“ æ–°å·¥ä½œåŒº
```
/mnt/tidal-alsh-hilab/usr/shenguobin/verl/recipe/geoguessr/dist_data/
```

## âœ… å·²å®Œæˆ
- âœ… åˆ›å»ºæ–°ç›®å½• `dist_data/`
- âœ… å®ç° `GeoguessrRLHFDatasetDistributed` (æ•°æ®åˆ†ç‰‡æ”¯æŒ)
- âœ… åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_phase1_data_sharding.py`
- âœ… æ–‡æ¡£å’Œ README

## ğŸ¯ å½“å‰çŠ¶æ€ï¼šPhase 1 ç­‰å¾…æµ‹è¯•

## ğŸ“ ä¸‹ä¸€æ­¥æ“ä½œï¼ˆéœ€è¦ä½ ï¼‰

### Step 1: æä¾›æ•°æ®è·¯å¾„

è¯·å‘Šè¯‰æˆ‘ä½ çš„è®­ç»ƒæ•°æ®è·¯å¾„ã€‚æˆ‘éœ€è¦æ›´æ–°æµ‹è¯•è„šæœ¬ä¸­çš„è·¯å¾„ï¼š

```python
# åœ¨ test_phase1_data_sharding.py ä¸­
data_files = [
    "ä½ çš„æ•°æ®è·¯å¾„"  # â† éœ€è¦ä½ æä¾›
]
```

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰¾åˆ°ï¼š
```bash
# æŸ¥çœ‹ä½ å½“å‰è®­ç»ƒé…ç½®
cat run/plain_rlvr/qwen2_5-vl-7b-it-tk-ray-dist.sh | grep data_path

# æˆ–è€…æŸ¥æ‰¾ parquet æ–‡ä»¶
find /mnt -name "*.parquet" -path "*geoguessr*" 2>/dev/null
```

### Step 2: è¿è¡Œ Phase 1 æµ‹è¯•

ä¸€æ—¦ä½ æä¾›äº†æ•°æ®è·¯å¾„ï¼Œæˆ‘ä¼šæ›´æ–°è„šæœ¬ï¼Œç„¶åä½ è¿è¡Œï¼š

```bash
cd /mnt/tidal-alsh-hilab/usr/shenguobin/verl/recipe/geoguessr/dist_data
source /mnt/tidal-alsh-hilab/usr/shenguobin/verl/.venv/bin/activate
python test_phase1_data_sharding.py
```

**é¢„æœŸè¾“å‡ºï¼š**
- âœ… æ•°æ®åŠ è½½æˆåŠŸ
- âœ… æ•°æ®åˆ†ç‰‡éªŒè¯é€šè¿‡
- âœ… 2/4/8/16/64 workers æµ‹è¯•é€šè¿‡

**é¢„æœŸæ—¶é—´ï¼š** 2-3 åˆ†é’Ÿ

## ğŸ“Š æµ‹è¯•å†…å®¹

Phase 1 æµ‹è¯•ä¼šéªŒè¯ï¼š
1. Dataset èƒ½æ­£ç¡®åŠ è½½æ•°æ®
2. æ•°æ®åˆ†ç‰‡é€»è¾‘æ­£ç¡®ï¼ˆæ¯ä¸ª worker ä¸é‡å¤ï¼‰
3. æ‰€æœ‰ workers çš„æ•°æ®æ€»å’Œ = åŸå§‹æ•°æ®
4. æ”¯æŒä»»æ„ world_size (2, 4, 8, 16, 64)

## âš ï¸ é‡è¦æé†’

- âœ… **ä¸å ç”¨ GPU**: æµ‹è¯•åªä½¿ç”¨ CPUï¼Œä¸å½±å“ä½ çš„è®­ç»ƒ
- âœ… **å¿«é€Ÿæµ‹è¯•**: åªåŠ è½½ 1000 ä¸ªæ ·æœ¬ï¼Œ2-3 åˆ†é’Ÿå®Œæˆ
- âœ… **ç‹¬ç«‹è¿è¡Œ**: åœ¨æ–°ç›®å½•ï¼Œä¸å½±å“ç°æœ‰ä»£ç 

## ğŸ”„ åç»­ Phases

Phase 1 å®Œæˆåï¼Œæˆ‘ä»¬ç»§ç»­ï¼š
- **Phase 2**: Ray workers åˆ†å¸ƒå¼æµ‹è¯• (ç”¨ CPU)
- **Phase 3**: Worker é›†æˆ DataLoader (ç”¨ CPU)
- **Phase 4**: ç­‰ä½ çš„è®­ç»ƒå®Œæˆåï¼Œé›†æˆåˆ°å®Œæ•´è®­ç»ƒæµç¨‹ (ç”¨ GPU)

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å‘Šè¯‰æˆ‘ï¼š
1. ä½ çš„æ•°æ®è·¯å¾„
2. è¿è¡Œæµ‹è¯•çš„ä»»ä½•é”™è¯¯ä¿¡æ¯

æˆ‘ä¼šç«‹å³å¸®ä½ è§£å†³ï¼

---

**ç­‰å¾…ä½ çš„è¾“å…¥ï¼šæ•°æ®è·¯å¾„** ğŸ“‚
