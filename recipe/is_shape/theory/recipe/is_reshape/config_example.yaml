# IS Reshape Example Configuration
#
# This configuration shows how to use IS Reshape with veRL.
# IS Reshape provides a unified framework connecting SFT and RL.
#
# Key parameters:
# - is_reshape.rho_min: Minimum ESS ratio (controls variance tolerance)
# - is_reshape.adaptive_gamma: Whether to dynamically compute γ
# - is_reshape.use_ppo_clip: Whether to combine with PPO clipping

algorithm:
  adv_estimator: grpo  # or gae, rloo, etc.

actor:
  loss_mode: is_reshape  # Use IS Reshape policy loss
  clip_ratio: 0.2  # PPO clip ratio (used if use_ppo_clip=True)
  clip_ratio_low: 0.2
  clip_ratio_high: 0.2

  # IS Reshape specific configuration
  is_reshape:
    # Core parameters
    rho_min: 0.3           # Minimum ESS ratio (default: 0.3)
                           # Lower = allow more variance, γ can be larger
                           # Higher = less variance, γ will be smaller

    gamma_min: 0.0         # Minimum γ value (default: 0.0 = SFT)
    gamma_max: 1.0         # Maximum γ value (default: 1.0 = full RL)

    # Gamma selection mode
    adaptive_gamma: true   # Dynamically compute γ* = min(1, √(-log ρ_min / σ²))
    fixed_gamma: 0.5       # Only used if adaptive_gamma=False

    # PPO clipping (optional, for additional stability)
    use_ppo_clip: true     # Whether to also apply PPO clipping on top of IS Reshape
                           # Set to false for pure IS Reshape (variance controlled by γ only)

# Example for pure SFT-like behavior (γ=0)
# actor:
#   loss_mode: is_reshape_sft

# Example for pure IS Reshape without PPO clipping
# actor:
#   loss_mode: is_reshape_pure
